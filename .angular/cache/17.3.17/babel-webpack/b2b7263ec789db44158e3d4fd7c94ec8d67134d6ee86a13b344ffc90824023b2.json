{"ast":null,"code":"import _asyncToGenerator from \"D:/Project/github-teams/teams-app-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport { AutoRefreshTokenCredential } from \"./autoRefreshTokenCredential.js\";\nimport { StaticTokenCredential } from \"./staticTokenCredential.js\";\nimport { parseToken } from \"./tokenParser.js\";\nimport { EntraTokenCredential } from \"./entraTokenCredential.js\";\n/**\n * The CommunicationTokenCredential implementation with support for proactive token refresh.\n */\nexport class AzureCommunicationTokenCredential {\n  constructor(tokenOrRefreshOptionsOrEntraOptions) {\n    this.disposed = false;\n    if (typeof tokenOrRefreshOptionsOrEntraOptions === \"string\") {\n      this.tokenCredential = new StaticTokenCredential(parseToken(tokenOrRefreshOptionsOrEntraOptions));\n    } else if (\"tokenRefresher\" in tokenOrRefreshOptionsOrEntraOptions) {\n      this.tokenCredential = new AutoRefreshTokenCredential(tokenOrRefreshOptionsOrEntraOptions);\n    } else {\n      this.tokenCredential = new EntraTokenCredential(tokenOrRefreshOptionsOrEntraOptions);\n    }\n  }\n  /**\n   * Gets an `AccessToken` for the user. Throws if already disposed.\n   * @param abortSignal - An implementation of `AbortSignalLike` to cancel the operation.\n   */\n  getToken(options) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.throwIfDisposed();\n      const token = yield _this.tokenCredential.getToken(options);\n      _this.throwIfDisposed();\n      return token;\n    })();\n  }\n  /**\n   * Disposes the CommunicationTokenCredential and cancels any internal auto-refresh operation.\n   */\n  dispose() {\n    this.disposed = true;\n    this.tokenCredential.dispose();\n  }\n  throwIfDisposed() {\n    if (this.disposed) {\n      throw new Error(\"User credential is disposed\");\n    }\n  }\n}\n//# sourceMappingURL=azureCommunicationTokenCredential.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}