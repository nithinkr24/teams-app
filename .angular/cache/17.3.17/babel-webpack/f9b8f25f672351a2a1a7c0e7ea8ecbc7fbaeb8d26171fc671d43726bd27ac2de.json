{"ast":null,"code":"import _asyncToGenerator from \"D:/Project/github-teams/teams-app-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _TeamsFxService;\nimport { BehaviorSubject } from 'rxjs';\nimport { app } from \"@microsoft/teams-js\";\nimport * as i0 from \"@angular/core\";\nexport class TeamsFxService {\n  constructor() {\n    this.teamsContextSubject = new BehaviorSubject({\n      themeString: 'default',\n      teamsUserCredential: undefined\n    });\n    this.teamsContext$ = this.teamsContextSubject.asObservable();\n    this.initializeTeams();\n  }\n  initializeTeams() {\n    return _asyncToGenerator(function* () {\n      try {\n        yield app.initialize();\n      } catch (error) {\n        console.error('Failed to initialize Teams:', error);\n      }\n    })();\n  }\n  getTeamsContext() {\n    return this.teamsContextSubject.value;\n  }\n  getUserInfo() {\n    return _asyncToGenerator(function* () {\n      try {\n        const context = yield app.getContext();\n        if (!context.user) {\n          console.error('User context is undefined');\n          return null;\n        }\n        return {\n          objectId: context.user.id,\n          displayName: context.user.displayName\n        };\n      } catch (error) {\n        console.error('Failed to get user info:', error);\n        return null;\n      }\n    })();\n  }\n}\n_TeamsFxService = TeamsFxService;\n_TeamsFxService.ɵfac = function TeamsFxService_Factory(t) {\n  return new (t || _TeamsFxService)();\n};\n_TeamsFxService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _TeamsFxService,\n  factory: _TeamsFxService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["BehaviorSubject","app","TeamsFxService","constructor","teamsContextSubject","themeString","teamsUserCredential","undefined","teamsContext$","asObservable","initializeTeams","_asyncToGenerator","initialize","error","console","getTeamsContext","value","getUserInfo","context","getContext","user","objectId","id","displayName","factory","ɵfac","providedIn"],"sources":["D:\\Project\\github-teams\\teams-app-new\\src\\app\\teams-fx.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { app, Context } from \"@microsoft/teams-js\";\r\n\r\nexport interface TeamsContext {\r\n  themeString: string;\r\n  teamsUserCredential?: any;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TeamsFxService {\r\n  private teamsContextSubject = new BehaviorSubject<TeamsContext>({\r\n    themeString: 'default',\r\n    teamsUserCredential: undefined\r\n  });\r\n\r\n  public teamsContext$: Observable<TeamsContext> = this.teamsContextSubject.asObservable();\r\n\r\n  constructor() {\r\n    this.initializeTeams();\r\n  }\r\n\r\n  private async initializeTeams() {\r\n    try {\r\n      await app.initialize();\r\n    } catch (error) {\r\n      console.error('Failed to initialize Teams:', error);\r\n    }\r\n  }\r\n\r\n  public getTeamsContext(): TeamsContext {\r\n    return this.teamsContextSubject.value;\r\n  }\r\n\r\n  public async getUserInfo(): Promise<any> {\r\n    try {\r\n      const context = await app.getContext();\r\n      if (!context.user) {\r\n        console.error('User context is undefined');\r\n        return null;\r\n      }\r\n      return {\r\n        objectId: context.user.id,\r\n        displayName: context.user.displayName,\r\n      };\r\n    } catch (error) {\r\n      console.error('Failed to get user info:', error);\r\n      return null;\r\n    }\r\n  }\r\n}\r\n"],"mappings":";;AACA,SAASA,eAAe,QAAoB,MAAM;AAClD,SAASC,GAAG,QAAiB,qBAAqB;;AAUlD,OAAM,MAAOC,cAAc;EAQzBC,YAAA;IAPQ,KAAAC,mBAAmB,GAAG,IAAIJ,eAAe,CAAe;MAC9DK,WAAW,EAAE,SAAS;MACtBC,mBAAmB,EAAEC;KACtB,CAAC;IAEK,KAAAC,aAAa,GAA6B,IAAI,CAACJ,mBAAmB,CAACK,YAAY,EAAE;IAGtF,IAAI,CAACC,eAAe,EAAE;EACxB;EAEcA,eAAeA,CAAA;IAAA,OAAAC,iBAAA;MAC3B,IAAI;QACF,MAAMV,GAAG,CAACW,UAAU,EAAE;OACvB,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;;IACpD;EACH;EAEOE,eAAeA,CAAA;IACpB,OAAO,IAAI,CAACX,mBAAmB,CAACY,KAAK;EACvC;EAEaC,WAAWA,CAAA;IAAA,OAAAN,iBAAA;MACtB,IAAI;QACF,MAAMO,OAAO,SAASjB,GAAG,CAACkB,UAAU,EAAE;QACtC,IAAI,CAACD,OAAO,CAACE,IAAI,EAAE;UACjBN,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAC;UAC1C,OAAO,IAAI;;QAEb,OAAO;UACLQ,QAAQ,EAAEH,OAAO,CAACE,IAAI,CAACE,EAAE;UACzBC,WAAW,EAAEL,OAAO,CAACE,IAAI,CAACG;SAC3B;OACF,CAAC,OAAOV,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;QAChD,OAAO,IAAI;;IACZ;EACH;;kBAvCWX,cAAc;;mBAAdA,eAAc;AAAA;;SAAdA,eAAc;EAAAsB,OAAA,EAAdtB,eAAc,CAAAuB,IAAA;EAAAC,UAAA,EAFb;AAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}