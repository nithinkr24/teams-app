{"ast":null,"code":"// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport { isObject } from \"./object.js\";\nconst RedactedString = \"REDACTED\";\n// Make sure this list is up-to-date with the one under core/logger/Readme#Keyconcepts\nconst defaultAllowedHeaderNames = [\"x-ms-client-request-id\", \"x-ms-return-client-request-id\", \"x-ms-useragent\", \"x-ms-correlation-request-id\", \"x-ms-request-id\", \"client-request-id\", \"ms-cv\", \"return-client-request-id\", \"traceparent\", \"Access-Control-Allow-Credentials\", \"Access-Control-Allow-Headers\", \"Access-Control-Allow-Methods\", \"Access-Control-Allow-Origin\", \"Access-Control-Expose-Headers\", \"Access-Control-Max-Age\", \"Access-Control-Request-Headers\", \"Access-Control-Request-Method\", \"Origin\", \"Accept\", \"Accept-Encoding\", \"Cache-Control\", \"Connection\", \"Content-Length\", \"Content-Type\", \"Date\", \"ETag\", \"Expires\", \"If-Match\", \"If-Modified-Since\", \"If-None-Match\", \"If-Unmodified-Since\", \"Last-Modified\", \"Pragma\", \"Request-Id\", \"Retry-After\", \"Server\", \"Transfer-Encoding\", \"User-Agent\", \"WWW-Authenticate\"];\nconst defaultAllowedQueryParameters = [\"api-version\"];\n/**\n * A utility class to sanitize objects for logging.\n */\nexport class Sanitizer {\n  constructor({\n    additionalAllowedHeaderNames: allowedHeaderNames = [],\n    additionalAllowedQueryParameters: allowedQueryParameters = []\n  } = {}) {\n    allowedHeaderNames = defaultAllowedHeaderNames.concat(allowedHeaderNames);\n    allowedQueryParameters = defaultAllowedQueryParameters.concat(allowedQueryParameters);\n    this.allowedHeaderNames = new Set(allowedHeaderNames.map(n => n.toLowerCase()));\n    this.allowedQueryParameters = new Set(allowedQueryParameters.map(p => p.toLowerCase()));\n  }\n  /**\n   * Sanitizes an object for logging.\n   * @param obj - The object to sanitize\n   * @returns - The sanitized object as a string\n   */\n  sanitize(obj) {\n    const seen = new Set();\n    return JSON.stringify(obj, (key, value) => {\n      // Ensure Errors include their interesting non-enumerable members\n      if (value instanceof Error) {\n        return Object.assign(Object.assign({}, value), {\n          name: value.name,\n          message: value.message\n        });\n      }\n      if (key === \"headers\") {\n        return this.sanitizeHeaders(value);\n      } else if (key === \"url\") {\n        return this.sanitizeUrl(value);\n      } else if (key === \"query\") {\n        return this.sanitizeQuery(value);\n      } else if (key === \"body\") {\n        // Don't log the request body\n        return undefined;\n      } else if (key === \"response\") {\n        // Don't log response again\n        return undefined;\n      } else if (key === \"operationSpec\") {\n        // When using sendOperationRequest, the request carries a massive\n        // field with the autorest spec. No need to log it.\n        return undefined;\n      } else if (Array.isArray(value) || isObject(value)) {\n        if (seen.has(value)) {\n          return \"[Circular]\";\n        }\n        seen.add(value);\n      }\n      return value;\n    }, 2);\n  }\n  /**\n   * Sanitizes a URL for logging.\n   * @param value - The URL to sanitize\n   * @returns - The sanitized URL as a string\n   */\n  sanitizeUrl(value) {\n    if (typeof value !== \"string\" || value === null || value === \"\") {\n      return value;\n    }\n    const url = new URL(value);\n    if (!url.search) {\n      return value;\n    }\n    for (const [key] of url.searchParams) {\n      if (!this.allowedQueryParameters.has(key.toLowerCase())) {\n        url.searchParams.set(key, RedactedString);\n      }\n    }\n    return url.toString();\n  }\n  sanitizeHeaders(obj) {\n    const sanitized = {};\n    for (const key of Object.keys(obj)) {\n      if (this.allowedHeaderNames.has(key.toLowerCase())) {\n        sanitized[key] = obj[key];\n      } else {\n        sanitized[key] = RedactedString;\n      }\n    }\n    return sanitized;\n  }\n  sanitizeQuery(value) {\n    if (typeof value !== \"object\" || value === null) {\n      return value;\n    }\n    const sanitized = {};\n    for (const k of Object.keys(value)) {\n      if (this.allowedQueryParameters.has(k.toLowerCase())) {\n        sanitized[k] = value[k];\n      } else {\n        sanitized[k] = RedactedString;\n      }\n    }\n    return sanitized;\n  }\n}","map":{"version":3,"names":["isObject","RedactedString","defaultAllowedHeaderNames","defaultAllowedQueryParameters","Sanitizer","constructor","additionalAllowedHeaderNames","allowedHeaderNames","additionalAllowedQueryParameters","allowedQueryParameters","concat","Set","map","n","toLowerCase","p","sanitize","obj","seen","JSON","stringify","key","value","Error","Object","assign","name","message","sanitizeHeaders","sanitizeUrl","sanitizeQuery","undefined","Array","isArray","has","add","url","URL","search","searchParams","set","toString","sanitized","keys","k"],"sources":["D:/Project/github-teams/teams-app-new/node_modules/@typespec/ts-http-runtime/dist/browser/util/sanitizer.js"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport { isObject } from \"./object.js\";\nconst RedactedString = \"REDACTED\";\n// Make sure this list is up-to-date with the one under core/logger/Readme#Keyconcepts\nconst defaultAllowedHeaderNames = [\n    \"x-ms-client-request-id\",\n    \"x-ms-return-client-request-id\",\n    \"x-ms-useragent\",\n    \"x-ms-correlation-request-id\",\n    \"x-ms-request-id\",\n    \"client-request-id\",\n    \"ms-cv\",\n    \"return-client-request-id\",\n    \"traceparent\",\n    \"Access-Control-Allow-Credentials\",\n    \"Access-Control-Allow-Headers\",\n    \"Access-Control-Allow-Methods\",\n    \"Access-Control-Allow-Origin\",\n    \"Access-Control-Expose-Headers\",\n    \"Access-Control-Max-Age\",\n    \"Access-Control-Request-Headers\",\n    \"Access-Control-Request-Method\",\n    \"Origin\",\n    \"Accept\",\n    \"Accept-Encoding\",\n    \"Cache-Control\",\n    \"Connection\",\n    \"Content-Length\",\n    \"Content-Type\",\n    \"Date\",\n    \"ETag\",\n    \"Expires\",\n    \"If-Match\",\n    \"If-Modified-Since\",\n    \"If-None-Match\",\n    \"If-Unmodified-Since\",\n    \"Last-Modified\",\n    \"Pragma\",\n    \"Request-Id\",\n    \"Retry-After\",\n    \"Server\",\n    \"Transfer-Encoding\",\n    \"User-Agent\",\n    \"WWW-Authenticate\",\n];\nconst defaultAllowedQueryParameters = [\"api-version\"];\n/**\n * A utility class to sanitize objects for logging.\n */\nexport class Sanitizer {\n    constructor({ additionalAllowedHeaderNames: allowedHeaderNames = [], additionalAllowedQueryParameters: allowedQueryParameters = [], } = {}) {\n        allowedHeaderNames = defaultAllowedHeaderNames.concat(allowedHeaderNames);\n        allowedQueryParameters = defaultAllowedQueryParameters.concat(allowedQueryParameters);\n        this.allowedHeaderNames = new Set(allowedHeaderNames.map((n) => n.toLowerCase()));\n        this.allowedQueryParameters = new Set(allowedQueryParameters.map((p) => p.toLowerCase()));\n    }\n    /**\n     * Sanitizes an object for logging.\n     * @param obj - The object to sanitize\n     * @returns - The sanitized object as a string\n     */\n    sanitize(obj) {\n        const seen = new Set();\n        return JSON.stringify(obj, (key, value) => {\n            // Ensure Errors include their interesting non-enumerable members\n            if (value instanceof Error) {\n                return Object.assign(Object.assign({}, value), { name: value.name, message: value.message });\n            }\n            if (key === \"headers\") {\n                return this.sanitizeHeaders(value);\n            }\n            else if (key === \"url\") {\n                return this.sanitizeUrl(value);\n            }\n            else if (key === \"query\") {\n                return this.sanitizeQuery(value);\n            }\n            else if (key === \"body\") {\n                // Don't log the request body\n                return undefined;\n            }\n            else if (key === \"response\") {\n                // Don't log response again\n                return undefined;\n            }\n            else if (key === \"operationSpec\") {\n                // When using sendOperationRequest, the request carries a massive\n                // field with the autorest spec. No need to log it.\n                return undefined;\n            }\n            else if (Array.isArray(value) || isObject(value)) {\n                if (seen.has(value)) {\n                    return \"[Circular]\";\n                }\n                seen.add(value);\n            }\n            return value;\n        }, 2);\n    }\n    /**\n     * Sanitizes a URL for logging.\n     * @param value - The URL to sanitize\n     * @returns - The sanitized URL as a string\n     */\n    sanitizeUrl(value) {\n        if (typeof value !== \"string\" || value === null || value === \"\") {\n            return value;\n        }\n        const url = new URL(value);\n        if (!url.search) {\n            return value;\n        }\n        for (const [key] of url.searchParams) {\n            if (!this.allowedQueryParameters.has(key.toLowerCase())) {\n                url.searchParams.set(key, RedactedString);\n            }\n        }\n        return url.toString();\n    }\n    sanitizeHeaders(obj) {\n        const sanitized = {};\n        for (const key of Object.keys(obj)) {\n            if (this.allowedHeaderNames.has(key.toLowerCase())) {\n                sanitized[key] = obj[key];\n            }\n            else {\n                sanitized[key] = RedactedString;\n            }\n        }\n        return sanitized;\n    }\n    sanitizeQuery(value) {\n        if (typeof value !== \"object\" || value === null) {\n            return value;\n        }\n        const sanitized = {};\n        for (const k of Object.keys(value)) {\n            if (this.allowedQueryParameters.has(k.toLowerCase())) {\n                sanitized[k] = value[k];\n            }\n            else {\n                sanitized[k] = RedactedString;\n            }\n        }\n        return sanitized;\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}