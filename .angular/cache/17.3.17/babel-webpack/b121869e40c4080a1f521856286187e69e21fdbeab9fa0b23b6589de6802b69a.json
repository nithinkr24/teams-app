{"ast":null,"code":"import { sendMessageToParentAsync as e } from \"../internal/communication.js\";\nimport { ensureInitialized as t } from \"../internal/internalAPIs.js\";\nimport { ResponseHandler as n } from \"../internal/responseHandler.js\";\nimport { getApiVersionTag as i } from \"../internal/telemetry.js\";\nimport { isPrimitiveOrPlainObject as r, validateId as o, validateUrl as s } from \"../internal/utils.js\";\nimport { FrameContexts as a, errorNotSupportedOnPlatform as u } from \"../public/constants.js\";\nimport { runtime as c } from \"../public/runtime.js\";\nimport { AppId as h } from \"../public/appId.js\";\nconst l = \"v2\";\nclass p {\n  constructor(e) {\n    this.invokeRequest = e;\n  }\n  serialize() {\n    return this.invokeRequest;\n  }\n}\nfunction f(e) {\n  const t = e;\n  return t.responseType === R.ActionExecuteInvokeResponse && void 0 !== t.value && void 0 !== t.statusCode && void 0 !== t.type;\n}\nconst m = \"Action.Execute\";\nvar d, R, A;\n!function (e) {\n  e.ActionExecuteInvokeRequest = \"ActionExecuteInvokeRequest\", e.QueryMessageExtensionRequest = \"QueryMessageExtensionRequest\";\n}(d || (d = {})), function (e) {\n  e.ActionExecuteInvokeResponse = \"ActionExecuteInvokeResponse\", e.QueryMessageExtensionResponse = \"QueryMessageExtensionResponse\";\n}(R || (R = {}));\nclass x extends n {\n  validate(e) {\n    return f(e);\n  }\n  deserialize(e) {\n    return e;\n  }\n}\nfunction w(e) {\n  if (\"object\" != typeof e || null === e) return !1;\n  const t = e;\n  return Object.values(A).includes(t.errorCode) && (void 0 === t.message || \"string\" == typeof t.message);\n}\nfunction E(e) {\n  e.requestType === d.ActionExecuteInvokeRequest ? v(e) : e.requestType === d.QueryMessageExtensionRequest && function (e) {\n    if (e.commandId.length > 64) throw new Error(\"originalRequestInfo.commandId exceeds the maximum size of 64 characters\");\n    if (e.parameters.length > 5) throw new Error(\"originalRequestInfo.parameters exceeds the maximum size of 5\");\n    for (const t of e.parameters) {\n      if (t.name.length > 64) throw new Error(\"originalRequestInfo.parameters.name exceeds the maximum size of 64 characters\");\n      if (t.value.length > 512) throw new Error(\"originalRequestInfo.parameters.value exceeds the maximum size of 512 characters\");\n    }\n  }(e);\n}\nfunction v(e) {\n  if (e.type !== m) {\n    throw {\n      errorCode: A.INTERNAL_ERROR,\n      message: `Invalid action type ${e.type}. Action type must be \"${m}\"`\n    };\n  }\n  if (!r(e.data)) {\n    throw {\n      errorCode: A.INTERNAL_ERROR,\n      message: `Invalid data type ${typeof e.data}. Data must be a primitive or a plain object.`\n    };\n  }\n}\nfunction g(n, r, o) {\n  if (t(c, a.content), !j()) throw u;\n  const s = new h(n);\n  return E(o), e(i(l, \"externalAppAuthentication.authenticateAndResendRequest\"), \"externalAppAuthentication.authenticateAndResendRequest\", [s.toString(), o, r.url.href, r.width, r.height, r.isExternal]).then(([e, t]) => {\n    if (e && null != t.responseType) return t;\n    throw t;\n  });\n}\nfunction I(n, r) {\n  if (t(c, a.content), !j()) throw u;\n  const o = new h(n);\n  return e(i(l, \"externalAppAuthentication.authenticateWithSSO\"), \"externalAppAuthentication.authenticateWithSSO\", [o.toString(), r.claims, r.silent]).then(([e, t]) => {\n    if (!e) throw t;\n  });\n}\nfunction y(n, r, o) {\n  if (t(c, a.content), !j()) throw u;\n  const s = new h(n);\n  return E(o), e(i(l, \"externalAppAuthentication.authenticateWithSSOAndResendRequest\"), \"externalAppAuthentication.authenticateWithSSOAndResendRequest\", [s.toString(), o, r.claims, r.silent]).then(([e, t]) => {\n    if (e && null != t.responseType) return t;\n    throw t;\n  });\n}\nfunction q(n, r, s) {\n  if (t(c, a.content), !j()) throw u;\n  return o(n, new Error(\"titleId is Invalid.\")), o(r, new Error(\"oauthConfigId is Invalid.\")), e(i(l, \"externalAppAuthentication.authenticateWithOauth2\"), \"externalAppAuthentication.authenticateWithOauth2\", [n, r, s.width, s.height, s.isExternal]).then(([e, t]) => {\n    if (!e) throw t;\n  });\n}\nfunction S(n, r, h) {\n  if (t(c, a.content), !j()) throw u;\n  return o(n, new Error(\"titleId is Invalid.\")), r && s(r), e(i(l, \"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins\"), \"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins\", [n, null == r ? void 0 : r.toString(), null == h ? void 0 : h.width, null == h ? void 0 : h.height, null == h ? void 0 : h.isExternal]).then(([e, t]) => {\n    if (!e) throw t;\n  });\n}\nfunction j() {\n  return !(!t(c) || !c.supports.externalAppAuthentication);\n}\n!function (e) {\n  e.INTERNAL_ERROR = \"INTERNAL_ERROR\";\n}(A || (A = {}));\nexport { m as ActionExecuteInvokeRequestType, x as ActionExecuteResponseHandler, A as InvokeErrorCode, R as InvokeResponseType, d as OriginalRequestType, p as SerializableActionExecuteInvokeRequest, g as authenticateAndResendRequest, q as authenticateWithOauth2, S as authenticateWithPowerPlatformConnectorPlugins, I as authenticateWithSSO, y as authenticateWithSSOAndResendRequest, f as isActionExecuteResponse, w as isInvokeError, j as isSupported, v as validateActionExecuteInvokeRequest };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}