{"ast":null,"code":"import { __awaiter as i } from \"../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js\";\nimport { sendMessageToParent as e, sendAndHandleStatusAndReason as t, callFunctionInHostAndHandleResponse as n, initializeCommunication as o } from \"./communication.js\";\nimport { errorLibraryNotInitialized as r, defaultSDKVersionForCompatCheck as s } from \"./constants.js\";\nimport { GlobalVars as l } from \"./globalVars.js\";\nimport { registerOnThemeChangeHandler as a, initializeHandlers as p } from \"./handlers.js\";\nimport { ensureInitializeCalled as u, ensureInitialized as m, processAdditionalValidOrigins as c } from \"./internalAPIs.js\";\nimport { getLogger as f } from \"./telemetry.js\";\nimport { isNullOrUndefined as d } from \"./typeCheckUtilities.js\";\nimport { inServerSideRenderingEnvironment as g, runWithTimeout as h, normalizeAgeGroupValue as S, compareSDKVersions as j } from \"./utils.js\";\nimport { Messages as v } from \"../public/app/app.js\";\nimport { FrameContexts as w } from \"../public/constants.js\";\nimport { initialize as y } from \"../public/dialog/dialog.js\";\nimport { initialize as z } from \"../public/menus.js\";\nimport { runtime as b, applyRuntimeConfig as P, generateVersionBasedTeamsRuntimeConfig as C, mapTeamsVersionToSupportedCapabilities as x, versionAndPlatformAgnosticTeamsRuntimeConfig as D } from \"../public/runtime.js\";\nimport { version as E } from \"../public/version.js\";\nimport { SimpleTypeResponseHandler as V } from \"./responseHandler.js\";\nimport { initialize as K } from \"../public/pages/config.js\";\nconst _ = f(\"app\");\nfunction k(i, e) {\n  if (g()) {\n    return _.extend(\"initialize\")(\"window object undefined at initialization\"), Promise.resolve();\n  }\n  return h(() => function (i, e) {\n    return new Promise(t => {\n      l.initializeCalled || (l.initializeCalled = !0, p(), l.initializePromise = o(e, i).then(({\n        context: i,\n        clientType: e,\n        runtimeConfig: t,\n        clientSupportedSDKVersion: n = s\n      }) => {\n        l.frameContext = i, l.hostClientType = e, l.clientSupportedSDKVersion = n;\n        try {\n          J(\"Parsing %s\", t);\n          let i = JSON.parse(t);\n          if (J(\"Checking if %o is a valid runtime object\", null != i ? i : \"null\"), !i || !i.apiVersion) throw new Error(\"Received runtime config is invalid\");\n          i = S(i), t && P(i);\n        } catch (i) {\n          if (!(i instanceof SyntaxError)) throw i;\n          try {\n            J(\"Attempting to parse %s as an SDK version\", t), isNaN(j(t, s)) || (l.clientSupportedSDKVersion = t);\n            let i = JSON.parse(n);\n            if (J(\"givenRuntimeConfig parsed to %o\", null != i ? i : \"null\"), !i) throw new Error(\"givenRuntimeConfig string was successfully parsed. However, it parsed to value of null\");\n            i = S(i), P(i);\n          } catch (i) {\n            if (!(i instanceof SyntaxError)) throw i;\n            P(C(l.clientSupportedSDKVersion, D, x));\n          }\n        }\n        l.initializeCompleted = !0;\n      }), z(), K(), y()), Array.isArray(e) && c(e), void 0 !== l.initializePromise ? t(l.initializePromise) : J(\"GlobalVars.initializePromise is unexpectedly undefined\");\n    });\n  }(i, e), 6e4, new Error(\"SDK initialization timed out.\"));\n}\nfunction A(i) {\n  e(i, v.AppLoaded, [E]);\n}\nfunction F(i, t) {\n  e(i, v.ExpectedFailure, [t.reason, t.message]);\n}\nfunction N(i, t) {\n  e(i, v.Failure, [t.reason, t.message]);\n}\nfunction R(e) {\n  return i(this, void 0, void 0, function* () {\n    if (l.initializeCompleted) return H(e);\n    if (!l.initializePromise) throw new Error(r);\n    return l.initializePromise.then(() => H(e));\n  });\n}\nfunction H(t) {\n  return i(this, void 0, void 0, function* () {\n    return m(b) && (null === (i = b.supports.app) || void 0 === i ? void 0 : i.notifySuccessResponse) ? n(v.Success, [E], new V(), t).then(() => ({\n      hasFinishedSuccessfully: !0\n    })) : (e(t, v.Success, [E]), {\n      hasFinishedSuccessfully: \"unknown\"\n    });\n    var i;\n  });\n}\nconst J = _.extend(\"initializeHelper\");\nfunction L(i, e) {\n  !d(e) && u(), a(i, e);\n}\nfunction O(i, e) {\n  return new Promise(n => {\n    m(b, w.content, w.sidePanel, w.settings, w.task, w.stage, w.meetingStage), n(t(i, \"executeDeepLink\", e));\n  });\n}\nexport { k as appInitializeHelper, H as callNotifySuccessInHost, A as notifyAppLoadedHelper, F as notifyExpectedFailureHelper, N as notifyFailureHelper, R as notifySuccessHelper, O as openLinkHelper, L as registerOnThemeChangeHandlerHelper };","map":{"version":3,"names":["__awaiter","i","sendMessageToParent","e","sendAndHandleStatusAndReason","t","callFunctionInHostAndHandleResponse","n","initializeCommunication","o","errorLibraryNotInitialized","r","defaultSDKVersionForCompatCheck","s","GlobalVars","l","registerOnThemeChangeHandler","a","initializeHandlers","p","ensureInitializeCalled","u","ensureInitialized","m","processAdditionalValidOrigins","c","getLogger","f","isNullOrUndefined","d","inServerSideRenderingEnvironment","g","runWithTimeout","h","normalizeAgeGroupValue","S","compareSDKVersions","j","Messages","v","FrameContexts","w","initialize","y","z","runtime","b","applyRuntimeConfig","P","generateVersionBasedTeamsRuntimeConfig","C","mapTeamsVersionToSupportedCapabilities","x","versionAndPlatformAgnosticTeamsRuntimeConfig","D","version","E","SimpleTypeResponseHandler","V","K","_","k","extend","Promise","resolve","initializeCalled","initializePromise","then","context","clientType","runtimeConfig","clientSupportedSDKVersion","frameContext","hostClientType","J","JSON","parse","apiVersion","Error","SyntaxError","isNaN","initializeCompleted","Array","isArray","A","AppLoaded","F","ExpectedFailure","reason","message","N","Failure","R","H","supports","app","notifySuccessResponse","Success","hasFinishedSuccessfully","L","O","content","sidePanel","settings","task","stage","meetingStage","appInitializeHelper","callNotifySuccessInHost","notifyAppLoadedHelper","notifyExpectedFailureHelper","notifyFailureHelper","notifySuccessHelper","openLinkHelper","registerOnThemeChangeHandlerHelper"],"sources":["D:/Project/github-teams/teams-app-new/node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/appHelpers.js"],"sourcesContent":["import{__awaiter as i}from\"../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js\";import{sendMessageToParent as e,sendAndHandleStatusAndReason as t,callFunctionInHostAndHandleResponse as n,initializeCommunication as o}from\"./communication.js\";import{errorLibraryNotInitialized as r,defaultSDKVersionForCompatCheck as s}from\"./constants.js\";import{GlobalVars as l}from\"./globalVars.js\";import{registerOnThemeChangeHandler as a,initializeHandlers as p}from\"./handlers.js\";import{ensureInitializeCalled as u,ensureInitialized as m,processAdditionalValidOrigins as c}from\"./internalAPIs.js\";import{getLogger as f}from\"./telemetry.js\";import{isNullOrUndefined as d}from\"./typeCheckUtilities.js\";import{inServerSideRenderingEnvironment as g,runWithTimeout as h,normalizeAgeGroupValue as S,compareSDKVersions as j}from\"./utils.js\";import{Messages as v}from\"../public/app/app.js\";import{FrameContexts as w}from\"../public/constants.js\";import{initialize as y}from\"../public/dialog/dialog.js\";import{initialize as z}from\"../public/menus.js\";import{runtime as b,applyRuntimeConfig as P,generateVersionBasedTeamsRuntimeConfig as C,mapTeamsVersionToSupportedCapabilities as x,versionAndPlatformAgnosticTeamsRuntimeConfig as D}from\"../public/runtime.js\";import{version as E}from\"../public/version.js\";import{SimpleTypeResponseHandler as V}from\"./responseHandler.js\";import{initialize as K}from\"../public/pages/config.js\";const _=f(\"app\");function k(i,e){if(g()){return _.extend(\"initialize\")(\"window object undefined at initialization\"),Promise.resolve()}return h((()=>function(i,e){return new Promise((t=>{l.initializeCalled||(l.initializeCalled=!0,p(),l.initializePromise=o(e,i).then((({context:i,clientType:e,runtimeConfig:t,clientSupportedSDKVersion:n=s})=>{l.frameContext=i,l.hostClientType=e,l.clientSupportedSDKVersion=n;try{J(\"Parsing %s\",t);let i=JSON.parse(t);if(J(\"Checking if %o is a valid runtime object\",null!=i?i:\"null\"),!i||!i.apiVersion)throw new Error(\"Received runtime config is invalid\");i=S(i),t&&P(i)}catch(i){if(!(i instanceof SyntaxError))throw i;try{J(\"Attempting to parse %s as an SDK version\",t),isNaN(j(t,s))||(l.clientSupportedSDKVersion=t);let i=JSON.parse(n);if(J(\"givenRuntimeConfig parsed to %o\",null!=i?i:\"null\"),!i)throw new Error(\"givenRuntimeConfig string was successfully parsed. However, it parsed to value of null\");i=S(i),P(i)}catch(i){if(!(i instanceof SyntaxError))throw i;P(C(l.clientSupportedSDKVersion,D,x))}}l.initializeCompleted=!0})),z(),K(),y()),Array.isArray(e)&&c(e),void 0!==l.initializePromise?t(l.initializePromise):J(\"GlobalVars.initializePromise is unexpectedly undefined\")}))}(i,e)),6e4,new Error(\"SDK initialization timed out.\"))}function A(i){e(i,v.AppLoaded,[E])}function F(i,t){e(i,v.ExpectedFailure,[t.reason,t.message])}function N(i,t){e(i,v.Failure,[t.reason,t.message])}function R(e){return i(this,void 0,void 0,(function*(){if(l.initializeCompleted)return H(e);if(!l.initializePromise)throw new Error(r);return l.initializePromise.then((()=>H(e)))}))}function H(t){return i(this,void 0,void 0,(function*(){return m(b)&&(null===(i=b.supports.app)||void 0===i?void 0:i.notifySuccessResponse)?n(v.Success,[E],new V,t).then((()=>({hasFinishedSuccessfully:!0}))):(e(t,v.Success,[E]),{hasFinishedSuccessfully:\"unknown\"});var i}))}const J=_.extend(\"initializeHelper\");function L(i,e){!d(e)&&u(),a(i,e)}function O(i,e){return new Promise((n=>{m(b,w.content,w.sidePanel,w.settings,w.task,w.stage,w.meetingStage),n(t(i,\"executeDeepLink\",e))}))}export{k as appInitializeHelper,H as callNotifySuccessInHost,A as notifyAppLoadedHelper,F as notifyExpectedFailureHelper,N as notifyFailureHelper,R as notifySuccessHelper,O as openLinkHelper,L as registerOnThemeChangeHandlerHelper};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}