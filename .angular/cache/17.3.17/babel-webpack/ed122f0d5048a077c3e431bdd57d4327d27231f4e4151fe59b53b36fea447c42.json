{"ast":null,"code":"var _TeamsAuthEndComponent;\nimport { app, authentication } from '@microsoft/teams-js';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nexport class TeamsAuthEndComponent {\n  constructor(route) {\n    this.route = route;\n  }\n  ngOnInit() {\n    app.initialize().then(() => {\n      this.route.queryParams.subscribe(params => {\n        const token = params['teamsreturntoken'];\n        if (token && token !== 'null') {\n          authentication.notifySuccess(JSON.stringify({\n            jenneToken: token\n          }));\n        } else {\n          authentication.notifyFailure(\"Token not found or is null\");\n        }\n      });\n    }).catch(err => {\n      console.error(\"Teams SDK initialization failed\", err);\n      authentication.notifyFailure(\"SDK Initialization Failed\");\n    });\n  }\n  ngOnDestroy() {}\n}\n_TeamsAuthEndComponent = TeamsAuthEndComponent;\n_TeamsAuthEndComponent.ɵfac = function TeamsAuthEndComponent_Factory(t) {\n  return new (t || _TeamsAuthEndComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute));\n};\n_TeamsAuthEndComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _TeamsAuthEndComponent,\n  selectors: [[\"teams-auth-end\"]],\n  decls: 0,\n  vars: 0,\n  template: function TeamsAuthEndComponent_Template(rf, ctx) {},\n  encapsulation: 2,\n  data: {\n    animation: []\n  }\n});","map":{"version":3,"names":["app","authentication","TeamsAuthEndComponent","constructor","route","ngOnInit","initialize","then","queryParams","subscribe","params","token","notifySuccess","JSON","stringify","jenneToken","notifyFailure","catch","err","console","error","ngOnDestroy","i0","ɵɵdirectiveInject","i1","ActivatedRoute","selectors","decls","vars","template","TeamsAuthEndComponent_Template","rf","ctx","encapsulation","data","animation"],"sources":["D:\\Project\\github-teams\\teams-app-new\\src\\app\\components\\teams-auth-end.component.ts"],"sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\r\n\r\nimport { app, authentication } from '@microsoft/teams-js';\r\nimport { ActivatedRoute } from '@angular/router';\r\n\r\n@Component({\r\n    selector: 'teams-auth-end',\r\n    template: '',\r\n    animations: []\r\n})\r\nexport class TeamsAuthEndComponent implements OnInit, OnDestroy {\r\n\r\n    constructor(\r\n        private route: ActivatedRoute,\r\n    ) { }\r\n\r\n    ngOnInit(): void {\r\n        app.initialize().then(() => {\r\n            this.route.queryParams.subscribe(params => {\r\n                const token = params['teamsreturntoken'];\r\n\r\n                if (token && token !== 'null') {\r\n                    authentication.notifySuccess(\r\n                        JSON.stringify({\r\n                            jenneToken: token,\r\n                        })\r\n                    )\r\n                } else {\r\n                    authentication.notifyFailure(\"Token not found or is null\");\r\n                }\r\n            });\r\n        }).catch(err => {\r\n            console.error(\"Teams SDK initialization failed\", err);\r\n            authentication.notifyFailure(\"SDK Initialization Failed\");\r\n        });\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n    }\r\n}\r\n"],"mappings":";AAEA,SAASA,GAAG,EAAEC,cAAc,QAAQ,qBAAqB;;;AAQzD,OAAM,MAAOC,qBAAqB;EAE9BC,YACYC,KAAqB;IAArB,KAAAA,KAAK,GAALA,KAAK;EACb;EAEJC,QAAQA,CAAA;IACJL,GAAG,CAACM,UAAU,EAAE,CAACC,IAAI,CAAC,MAAK;MACvB,IAAI,CAACH,KAAK,CAACI,WAAW,CAACC,SAAS,CAACC,MAAM,IAAG;QACtC,MAAMC,KAAK,GAAGD,MAAM,CAAC,kBAAkB,CAAC;QAExC,IAAIC,KAAK,IAAIA,KAAK,KAAK,MAAM,EAAE;UAC3BV,cAAc,CAACW,aAAa,CACxBC,IAAI,CAACC,SAAS,CAAC;YACXC,UAAU,EAAEJ;WACf,CAAC,CACL;SACJ,MAAM;UACHV,cAAc,CAACe,aAAa,CAAC,4BAA4B,CAAC;;MAElE,CAAC,CAAC;IACN,CAAC,CAAC,CAACC,KAAK,CAACC,GAAG,IAAG;MACXC,OAAO,CAACC,KAAK,CAAC,iCAAiC,EAAEF,GAAG,CAAC;MACrDjB,cAAc,CAACe,aAAa,CAAC,2BAA2B,CAAC;IAC7D,CAAC,CAAC;EACN;EAEAK,WAAWA,CAAA,GACX;;yBA5BSnB,qBAAqB;;mBAArBA,sBAAqB,EAAAoB,EAAA,CAAAC,iBAAA,CAAAC,EAAA,CAAAC,cAAA;AAAA;;QAArBvB,sBAAqB;EAAAwB,SAAA;EAAAC,KAAA;EAAAC,IAAA;EAAAC,QAAA,WAAAC,+BAAAC,EAAA,EAAAC,GAAA;EAAAC,aAAA;EAAAC,IAAA;IAAAC,SAAA,EAFlB;EAAE;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}