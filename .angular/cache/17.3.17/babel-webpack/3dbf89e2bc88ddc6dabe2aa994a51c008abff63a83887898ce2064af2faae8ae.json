{"ast":null,"code":"import { __rest as t } from \"../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js\";\nimport { sendMessageToParent as i } from \"../internal/communication.js\";\nimport { botUrlOpenHelper as o, urlOpenHelper as r, updateResizeHelper as e, urlSubmitHelper as n } from \"../internal/dialogHelpers.js\";\nimport { ensureInitialized as l } from \"../internal/internalAPIs.js\";\nimport { getApiVersionTag as s } from \"../internal/telemetry.js\";\nimport { ChildAppWindow as a } from \"./appWindow.js\";\nimport { FrameContexts as d, DialogDimension as u } from \"./constants.js\";\nimport { runtime as h } from \"./runtime.js\";\nconst m = \"v1\";\nfunction c(t, e) {\n  const n = s(m, \"tasks.startTask\"),\n    c = e ? t => {\n      var i, o;\n      return e(null !== (i = t.err) && void 0 !== i ? i : \"\", null !== (o = t.result) && void 0 !== o ? o : \"\");\n    } : void 0;\n  return void 0 === t.card && void 0 === t.url || t.card ? (l(h, d.content, d.sidePanel, d.meetingStage), i(n, \"tasks.startTask\", [t], e)) : void 0 !== t.completionBotId ? o(n, function (t) {\n    if (void 0 === t.url || void 0 === t.completionBotId) throw new Error(`Both url ${t.url} and completionBotId ${t.completionBotId} are required for bot url dialog. At least one is undefined.`);\n    const i = {\n      url: t.url,\n      size: {\n        height: t.height ? t.height : u.Small,\n        width: t.width ? t.width : u.Small\n      },\n      title: t.title,\n      fallbackUrl: t.fallbackUrl,\n      completionBotId: t.completionBotId\n    };\n    return i;\n  }(t), c) : r(n, function (t) {\n    if (void 0 === t.url) throw new Error(\"url property of taskInfo object can't be undefined\");\n    const i = {\n      url: t.url,\n      size: {\n        height: t.height ? t.height : u.Small,\n        width: t.width ? t.width : u.Small\n      },\n      title: t.title,\n      fallbackUrl: t.fallbackUrl\n    };\n    return i;\n  }(t), c), new a();\n}\nfunction p(i) {\n  i = g(i);\n  const o = t(i, [\"width\", \"height\"]);\n  if (Object.keys(o).length) throw new Error(\"resize requires a TaskInfo argument containing only width and height\");\n  e(s(m, \"tasks.updateTask\"), i);\n}\nfunction f(t, i) {\n  n(s(m, \"tasks.submitTask\"), t, i);\n}\nfunction g(t) {\n  return t.height = t.height ? t.height : u.Small, t.width = t.width ? t.width : u.Small, t;\n}\nexport { g as getDefaultSizeIfNotProvided, c as startTask, f as submitTask, p as updateTask };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}