{"ast":null,"code":"import _asyncToGenerator from \"D:/Project/github-teams/teams-app-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { BehaviorSubject } from 'rxjs';\nimport { app } from \"@microsoft/teams-js\";\nimport * as i0 from \"@angular/core\";\nexport let TeamsFxService = /*#__PURE__*/(() => {\n  var _TeamsFxService;\n  class TeamsFxService {\n    constructor() {\n      this.teamsContextSubject = new BehaviorSubject({\n        themeString: 'default',\n        teamsUserCredential: undefined\n      });\n      this.teamsContext$ = this.teamsContextSubject.asObservable();\n      this.initializeTeams();\n    }\n    initializeTeams() {\n      return _asyncToGenerator(function* () {\n        try {\n          yield app.initialize();\n        } catch (error) {\n          console.error('Failed to initialize Teams:', error);\n        }\n      })();\n    }\n    getTeamsContext() {\n      return this.teamsContextSubject.value;\n    }\n    getUserInfo() {\n      return _asyncToGenerator(function* () {\n        try {\n          const context = yield app.getContext();\n          if (!context.user) {\n            console.error('User context is undefined');\n            return null;\n          }\n          return {\n            objectId: context.user.id,\n            displayName: context.user.displayName\n          };\n        } catch (error) {\n          console.error('Failed to get user info:', error);\n          return null;\n        }\n      })();\n    }\n  }\n  _TeamsFxService = TeamsFxService;\n  _TeamsFxService.ɵfac = function TeamsFxService_Factory(t) {\n    return new (t || _TeamsFxService)();\n  };\n  _TeamsFxService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: _TeamsFxService,\n    factory: _TeamsFxService.ɵfac,\n    providedIn: 'root'\n  });\n  return TeamsFxService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}