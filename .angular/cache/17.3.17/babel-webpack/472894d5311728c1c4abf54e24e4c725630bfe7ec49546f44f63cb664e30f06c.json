{"ast":null,"code":"import { Buffer as t } from \"../../../../_virtual/_polyfill-node.buffer.js\";\nimport { minAdaptiveCardVersion as e } from \"../public/constants.js\";\nimport { LegalAgeGroupClassification as n } from \"../public/interfaces.js\";\nimport r from \"../../../../node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/v4.js\";\nimport o from \"../../../../node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/validate.js\";\nfunction i(t) {\n  return (t, e) => {\n    if (!t) throw new Error(e);\n  };\n}\nfunction s(t, e) {\n  if (\"string\" != typeof t || \"string\" != typeof e) return NaN;\n  const n = t.split(\".\"),\n    r = e.split(\".\");\n  function o(t) {\n    return /^\\d+$/.test(t);\n  }\n  if (!n.every(o) || !r.every(o)) return NaN;\n  for (; n.length < r.length;) n.push(\"0\");\n  for (; r.length < n.length;) r.push(\"0\");\n  for (let t = 0; t < n.length; ++t) if (Number(n[t]) != Number(r[t])) return Number(n[t]) > Number(r[t]) ? 1 : -1;\n  return 0;\n}\nfunction u() {\n  return r();\n}\nfunction c(t) {\n  return Object.keys(t).forEach(e => {\n    null !== t[e] && void 0 !== t[e] && \"object\" == typeof t[e] && c(t[e]);\n  }), Object.freeze(t);\n}\nfunction a(t, e, ...n) {\n  const r = t(...n);\n  return r.then(t => {\n    e && e(void 0, t);\n  }).catch(t => {\n    e && e(t);\n  }), r;\n}\nfunction l(t, e, ...n) {\n  const r = t(...n);\n  return r.then(() => {\n    e && e(null);\n  }).catch(t => {\n    e && e(t);\n  }), r;\n}\nfunction f(t, e, ...n) {\n  const r = t(...n);\n  return r.then(t => {\n    e && e(null, t);\n  }).catch(t => {\n    e && e(t, null);\n  }), r;\n}\nfunction p(t, e, n) {\n  return new Promise((r, o) => {\n    const i = setTimeout(o, e, n);\n    t().then(t => {\n      clearTimeout(i), r(t);\n    }).catch(t => {\n      clearTimeout(i), o(t);\n    });\n  });\n}\nfunction d(t) {\n  const e = new URL(\"https://teams.microsoft.com/l/entity/\" + encodeURIComponent(t.appId.toString()) + \"/\" + encodeURIComponent(t.pageId));\n  return t.webUrl && e.searchParams.append(\"webUrl\", t.webUrl.toString()), (t.chatId || t.channelId || t.subPageId) && e.searchParams.append(\"context\", JSON.stringify({\n    chatId: t.chatId,\n    channelId: t.channelId,\n    subEntityId: t.subPageId\n  })), e.toString();\n}\nfunction m(t) {\n  return !(s(`${t.majorVersion}.${t.minorVersion}`, `${e.majorVersion}.${e.minorVersion}`) >= 0);\n}\nfunction h(t) {\n  return \"https:\" === t.protocol;\n}\nfunction b(e, n) {\n  return new Promise((r, o) => {\n    if (e || o(\"MimeType cannot be null or empty.\"), n || o(\"Base64 string cannot be null or empty.\"), e.startsWith(\"image/\")) {\n      const t = atob(n),\n        o = new Uint8Array(t.length);\n      for (let e = 0; e < t.length; e++) o[e] = t.charCodeAt(e);\n      r(new Blob([o], {\n        type: e\n      }));\n    }\n    const i = t.from(n, \"base64\").toString();\n    r(new Blob([i], {\n      type: e\n    }));\n  });\n}\nfunction g(t) {\n  return new Promise((e, n) => {\n    0 === t.size && n(new Error(\"Blob cannot be empty.\"));\n    const r = new FileReader();\n    r.onloadend = () => {\n      r.result ? e(r.result.toString().split(\",\")[1]) : n(new Error(\"Failed to read the blob\"));\n    }, r.onerror = () => {\n      n(r.error);\n    }, r.readAsDataURL(t);\n  });\n}\nfunction w() {\n  if (y()) throw new Error(\"window object undefined at SSR check\");\n  return window;\n}\nfunction y() {\n  return \"undefined\" == typeof window;\n}\nfunction j(t, e) {\n  if (E(t) || !function (t) {\n    return t.length < 256 && t.length > 4;\n  }(t) || !function (t) {\n    for (let e = 0; e < t.length; e++) {\n      const n = t.charCodeAt(e);\n      if (n < 32 || n > 126) return !1;\n    }\n    return !0;\n  }(t)) throw e || new Error(\"id is not valid.\");\n}\nfunction I(t, e) {\n  const n = t.toString().toLocaleLowerCase();\n  if (E(n)) throw new Error(\"Invalid Url\");\n  if (n.length > 2048) throw new Error(\"Url exceeds the maximum size of 2048 characters\");\n  if (!h(t)) throw new Error(\"Url should be a valid https url\");\n}\nfunction v(t) {\n  const e = document.createElement(\"a\");\n  return e.href = t, new URL(e.href);\n}\nfunction E(t) {\n  return new RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\\/script[^>]*>|&lt;\\/script[^&]*&gt;|%3C\\/script[^%]*%3E/gi.source}`, \"gi\").test(t);\n}\nfunction O(t) {\n  if (!t) throw new Error(\"id must not be empty\");\n  if (!1 === o(t)) throw new Error(\"id must be a valid UUID\");\n}\nconst U = !!performance && \"now\" in performance;\nfunction N() {\n  return U ? performance.now() + performance.timeOrigin : void 0;\n}\nfunction S(t, e = 0) {\n  if (e > 1e3) return !1;\n  if (void 0 === t || \"boolean\" == typeof t || \"number\" == typeof t || \"bigint\" == typeof t || \"string\" == typeof t || null === t) return !0;\n  if (Array.isArray(t)) return t.every(t => S(t, e + 1));\n  return !(\"object\" != typeof t || \"[object Object]\" !== Object.prototype.toString.call(t) || Object.getPrototypeOf(t) !== Object.prototype && null !== Object.getPrototypeOf(t)) && Object.keys(t).every(n => S(t[n], e + 1));\n}\nfunction P(t) {\n  var e, r;\n  if (!(null === (r = null === (e = t.hostVersionsInfo) || void 0 === e ? void 0 : e.appEligibilityInformation) || void 0 === r ? void 0 : r.ageGroup)) return t;\n  const o = t.hostVersionsInfo.appEligibilityInformation.ageGroup;\n  return \"nonadult\" !== (null == o ? void 0 : o.toLowerCase()) ? t : Object.assign(Object.assign({}, t), {\n    hostVersionsInfo: Object.assign(Object.assign({}, t.hostVersionsInfo), {\n      appEligibilityInformation: Object.assign(Object.assign({}, t.hostVersionsInfo.appEligibilityInformation), {\n        ageGroup: n.NotAdult\n      })\n    })\n  });\n}\nexport { b as base64ToBlob, a as callCallbackWithErrorOrResultFromPromiseAndReturnPromise, f as callCallbackWithErrorOrResultOrNullFromPromiseAndReturnPromise, l as callCallbackWithSdkErrorFromPromiseAndReturnPromise, s as compareSDKVersions, d as createTeamsAppLink, c as deepFreeze, v as fullyQualifyUrlString, u as generateGUID, g as getBase64StringFromBlob, N as getCurrentTimestamp, i as getGenericOnCompleteHandler, E as hasScriptTags, y as inServerSideRenderingEnvironment, m as isHostAdaptiveCardSchemaVersionUnsupported, S as isPrimitiveOrPlainObject, h as isValidHttpsURL, P as normalizeAgeGroupValue, p as runWithTimeout, w as ssrSafeWindow, j as validateId, I as validateUrl, O as validateUuid };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}